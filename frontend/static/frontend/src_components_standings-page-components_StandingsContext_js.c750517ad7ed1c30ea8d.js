/*! For license information please see src_components_standings-page-components_StandingsContext_js.c750517ad7ed1c30ea8d.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["src_components_standings-page-components_StandingsContext_js"],{"./src/components/standings-page-components/StandingsContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (/* binding */ StandingsContextProvider),\n/* harmony export */   useStandingsContext: () => (/* binding */ useStandingsContext)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router/dist/index.js");\n/* harmony import */ var _fetch_utils_fetchGet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../fetch-utils/fetchGet */ "./src/components/fetch-utils/fetchGet.js");\n/* harmony import */ var _ApplicationContext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ApplicationContext */ "./src/components/ApplicationContext.js");\n\n\n\n\nconst StandingsContext = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)();\nfunction StandingsContextProvider() {\n  const {\n    setErrorMessage\n  } = (0,_ApplicationContext__WEBPACK_IMPORTED_MODULE_2__.useApplicationContext)();\n  const [standings, setStandings] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({});\n  const [standingsLoading, setStandingsLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n  const [profilePicturesLoading, setProfilePicturesLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n  const [userPicksDetailed, setUserPicksDetailed] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({});\n  const [userPicksDetailedLoading, setUserPicksDetailedLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n  const [seasonList, setSeasonList] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);\n  const [seasonListLoading, setSeasonListLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n  const [selectedSeason, setSelectedSeason] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({});\n  const [selectedSeasonLoading, setSelectedSeasonLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n  async function retrieveStandings() {\n    setStandingsLoading(true);\n    const params = new URLSearchParams(location.search);\n    const seasonYear = params.get("season");\n    const usersStandingsResponse = await (0,_fetch_utils_fetchGet__WEBPACK_IMPORTED_MODULE_1__.getSeasonStandings)(seasonYear);\n    if (usersStandingsResponse.error) {\n      console.log(usersStandingsResponse.error);\n      setErrorMessage("There was an error retrieving the standings");\n      return;\n    }\n    if (usersStandingsResponse.status === 200) {\n      setStandings(usersStandingsResponse.standings);\n      setStandingsLoading(false);\n    }\n  }\n  async function retrieveProfilePictures() {\n    if (!standings || Object.keys(standings).length == 0 || standings.users_picks.length == 0) {\n      return;\n    }\n    const users = standings.users_picks.map(user_picks => user_picks.user);\n    const profilePicturesResponse = await (0,_fetch_utils_fetchGet__WEBPACK_IMPORTED_MODULE_1__.getUsersProfilePictures)(users);\n    if (profilePicturesResponse.status !== 200) {\n      setErrorMessage("There was an error loading the profile pictures");\n      return;\n    }\n    const updatedUsersPicks = standings.users_picks.map((userPicks, index) => {\n      const updatedUser = {\n        ...userPicks.user,\n        profile_picture: profilePicturesResponse.users[index].profile_picture\n      };\n      return {\n        ...userPicks,\n        user: updatedUser\n      };\n    });\n    let updatedStandings = standings;\n    updatedStandings.users_picks = updatedUsersPicks;\n    setStandings(updatedStandings);\n    setProfilePicturesLoading(false);\n  }\n  async function retrieveSelectedSeason() {\n    setSelectedSeasonLoading(true);\n    const params = new URLSearchParams(location.search);\n    const seasonYear = params.get("season");\n    const seasonResponse = await (0,_fetch_utils_fetchGet__WEBPACK_IMPORTED_MODULE_1__.getSeasonSimple)(seasonYear);\n    if (seasonResponse.error) {\n      setErrorMessage("There was an error retrieving season data");\n      return;\n    }\n    if (seasonResponse.status != 200) {\n      setErrorMessage("Be sure to select a valid season");\n      return;\n    }\n    setSelectedSeason(seasonResponse.season);\n    setSelectedSeasonLoading(false);\n  }\n  async function retrieveSeasonList() {\n    setSeasonListLoading(true);\n    const seasonListResponse = await (0,_fetch_utils_fetchGet__WEBPACK_IMPORTED_MODULE_1__.getSeasonsSimpleYear)();\n    if (seasonListResponse.error || seasonListResponse.status != 200) {\n      setErrorMessage("There was an error retrieving the season list");\n      return;\n    }\n    setSeasonList(seasonListResponse.seasons);\n    setSeasonListLoading(false);\n  }\n  async function retrieveUserPicks(userId) {\n    setUserPicksDetailedLoading(true);\n    const userPicksResponse = await (0,_fetch_utils_fetchGet__WEBPACK_IMPORTED_MODULE_1__.getUserPicksSimple)(selectedSeason.id, userId);\n    if (userPicksResponse.error) {\n      setErrorMessage("There was an error retrieving the user picks");\n      return;\n    }\n    if (userPicksResponse.status == 404) {\n      setErrorMessage("The user picks was not found");\n      return;\n    }\n    if (userPicksResponse.status == 200) {\n      const profilePictureResponse = await (0,_fetch_utils_fetchGet__WEBPACK_IMPORTED_MODULE_1__.getUsersProfilePictures)(userPicksResponse.userPicks.user);\n      if (profilePictureResponse.error) {\n        setErrorMessage("There was an error loading the profile picture");\n        return;\n      }\n      if (profilePictureResponse.status == 404) {\n        setErrorMessage("User profile picture was not found");\n        return;\n      }\n      if (profilePictureResponse.status == 200) {\n        userPicksResponse.userPicks.user.profile_picture = profilePictureResponse.users[0].profile_picture;\n        setUserPicksDetailed(userPicksResponse.userPicks);\n        setUserPicksDetailedLoading(false);\n      }\n    }\n  }\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(StandingsContext.Provider, {\n    value: {\n      retrieveStandings,\n      retrieveSelectedSeason,\n      retrieveSeasonList,\n      retrieveUserPicks,\n      retrieveProfilePictures,\n      standings,\n      userPicksDetailed,\n      seasonList,\n      selectedSeason,\n      standingsLoading,\n      userPicksDetailedLoading,\n      seasonListLoading,\n      selectedSeasonLoading,\n      profilePicturesLoading\n    }\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_3__.Outlet, null));\n}\nfunction useStandingsContext() {\n  return (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(StandingsContext);\n}\n\n//# sourceURL=webpack://frontend/./src/components/standings-page-components/StandingsContext.js?')}}]);