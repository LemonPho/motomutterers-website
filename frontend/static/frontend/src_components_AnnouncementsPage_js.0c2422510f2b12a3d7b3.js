/*! For license information please see src_components_AnnouncementsPage_js.0c2422510f2b12a3d7b3.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["src_components_AnnouncementsPage_js"],{"./src/components/AnnouncementsPage.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (/* binding */ Anouncements)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router/dist/index.js");\n/* harmony import */ var _ApplicationContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ApplicationContext */ "./src/components/ApplicationContext.js");\n/* harmony import */ var _fetch_utils_fetchGet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./fetch-utils/fetchGet */ "./src/components/fetch-utils/fetchGet.js");\n/* harmony import */ var _fetch_utils_fetchPost__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./fetch-utils/fetchPost */ "./src/components/fetch-utils/fetchPost.js");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./utils */ "./src/components/utils.js");\n/* harmony import */ var _util_components_ProfilePictureLazyLoader__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./util-components/ProfilePictureLazyLoader */ "./src/components/util-components/ProfilePictureLazyLoader.js");\n\n\n\n\n\n\n\nfunction Anouncements() {\n  const [announcements, setAnnouncements] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);\n  const [announcementsLoading, setAnnouncementsLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n  const [totalAnnouncements, setTotalAnnouncements] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(0);\n  const {\n    user,\n    userLoading,\n    setErrorMessage,\n    setSuccessMessage,\n    resetApplicationMessages,\n    setLoadingMessage\n  } = (0,_ApplicationContext__WEBPACK_IMPORTED_MODULE_1__.useApplicationContext)();\n  const [pages, setPages] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n  const [currentPage, setCurrentPage] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(1);\n  const [previousPage, setPreviousPage] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("");\n  const [nextPage, setNextPage] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("");\n  const [pageNumbers, setPageNumbers] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);\n  const location = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_6__.useLocation)();\n  const [newAnnouncementText, setNewAnnouncementText] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("");\n  const [newAnnouncementTitle, setNewAnnouncementTitle] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("");\n  function resetNewAnnouncementVariables() {\n    setNewAnnouncementText("");\n    setNewAnnouncementTitle("");\n  }\n  async function retrieveAnnouncements() {\n    const params = new URLSearchParams(location.search);\n    let page = params.get("page");\n    setCurrentPage(page);\n    const announcementsResponse = await (0,_fetch_utils_fetchGet__WEBPACK_IMPORTED_MODULE_2__.getAnnouncements)(page);\n    if (announcementsResponse.error || announcementsResponse.status !== 200) {\n      setErrorMessage("There was an error while loading the announcements");\n      console.log(announcementsResponse.error);\n      return;\n    }\n    setAnnouncements(announcementsResponse.announcements);\n    setTotalAnnouncements(announcementsResponse.amountAnnouncements);\n  }\n\n  //when totalAnnouncements is asigned, we can generate the pagination necessary, no need to check if its 0, it will just generate a disabled pagination menu\n  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n    let result = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.pagination)(totalAnnouncements, 10, currentPage);\n    if (result !== null) {\n      setNextPage(result.nextPage);\n      setPreviousPage(result.previousPage);\n      setPageNumbers(result.pageNumbers);\n      setPages(true);\n    }\n  }, [totalAnnouncements]);\n  async function postAnnouncement() {\n    resetApplicationMessages();\n    setLoadingMessage("Loading..");\n    if (!user.is_admin) {\n      setErrorMessage("There was an error submiting the announcement");\n      return;\n    }\n    const announcementResponse = await (0,_fetch_utils_fetchPost__WEBPACK_IMPORTED_MODULE_3__.submitAnnouncement)(newAnnouncementTitle, newAnnouncementText);\n    if (announcementResponse.error) {\n      setErrorMessage("There was an error submiting the announcement");\n      return;\n    }\n    if (announcementResponse.status === 400) {\n      setErrorMessage("Be sure the title has less than 128 characters and the text 2048 characters");\n      return;\n    }\n    if (announcementResponse.status === 200) {\n      setSuccessMessage("Announcement posted");\n      setLoadingMessage(false);\n      retrieveAnnouncements();\n      (0,_utils__WEBPACK_IMPORTED_MODULE_4__.closeModals)();\n      return;\n    }\n    setErrorMessage("There was a server error while submiting the announcement");\n    return;\n  }\n  function handleAnnouncementTextChange(event) {\n    setNewAnnouncementText(event.target.value);\n  }\n  function handleAnnouncementTitleChange(event) {\n    setNewAnnouncementTitle(event.target.value);\n  }\n  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n    retrieveAnnouncements();\n    setAnnouncementsLoading(false);\n  }, []);\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {\n    className: "card element-background-color element-border-color rounded-15"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {\n    className: "card-header d-flex align-items-center"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("h5", null, "Announcements"), !userLoading && user.is_admin && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("button", {\n    className: "btn btn-primary ms-auto rounded-15",\n    onClick: e => {\n      resetNewAnnouncementVariables();\n      (0,_utils__WEBPACK_IMPORTED_MODULE_4__.toggleModal)("announcement-create-modal", e, undefined, user.is_admin);\n    }\n  }, "Create Announcement")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {\n    className: "card-body"\n  }, !announcementsLoading && announcements.length != 0 && announcements.map(announcement => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("a", {\n    className: "clickable card mx-auto my-3 rounded-15 element-background-color link-no-decorations",\n    href: `/announcements/${announcement.id}`,\n    key: announcement.id\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {\n    className: "card-header d-flex align-items-center"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_util_components_ProfilePictureLazyLoader__WEBPACK_IMPORTED_MODULE_5__["default"], {\n    width: "2rem",\n    height: "2rem",\n    format: announcement.user.profile_picture_format,\n    base64: announcement.user.profile_picture_data\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("small", {\n    className: "ms-2"\n  }, announcement.user.username), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("small", {\n    className: "ms-auto"\n  }, new Date(announcement.date_created).toISOString().substring(0, 10))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {\n    className: "card-body announcement-card-body"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("h5", null, announcement.title), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("span", null, announcement.text)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {\n    className: "card-footer"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("small", null, "Comments: ", announcement.amount_comments))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {\n    className: "card-footer"\n  }, pages && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("nav", {\n    id: "pagination-view "\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("ul", {\n    className: "pagination justify-content-center"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("li", {\n    id: "previous-page",\n    className: `${previousPage}`\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("a", {\n    id: "previous-page-link",\n    href: `announcements?page=${parseInt(currentPage) - 1}`,\n    className: "page-link"\n  }, "Previous")), pageNumbers.map(page => parseInt(currentPage) !== page ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("li", {\n    id: `page-${page}`,\n    key: `page-${page}`,\n    className: "page-item"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("a", {\n    id: `page-link-${page}`,\n    href: `announcements?page=${page}`,\n    className: "page-link"\n  }, page)) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("li", {\n    id: `page-${page}`,\n    key: `page-${page}`,\n    className: "page-item disabled"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("a", {\n    id: `page-link-${page}`,\n    href: `announcements?page=${page}`,\n    className: "page-link"\n  }, page))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("li", {\n    id: "next-page",\n    className: `${nextPage}`\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("a", {\n    id: "next-page-link",\n    href: `announcements?page=${parseInt(currentPage) + 1}`,\n    className: "page-link"\n  }, "Next"))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {\n    className: "custom-modal hidden",\n    id: "announcement-create-modal",\n    style: {\n      width: "50%"\n    },\n    onClick: e => {\n      e.stopPropagation();\n    }\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {\n    className: "custom-modal-header justify-content-center"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("h5", {\n    className: "m-0"\n  }, "Create announcement")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {\n    className: "custom-modal-body"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("hr", {\n    className: "m-1"\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {\n    className: "d-flex align-items-center"\n  }, !userLoading && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("img", {\n    className: "rounded-circle",\n    style: {\n      width: "3rem",\n      height: "3rem",\n      marginRight: "0.5rem"\n    },\n    src: `data: image/${user.profile_picture_format}; base64, ${user.profile_picture_data}`,\n    alt: ""\n  }), !userLoading && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("strong", null, user.username)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("textarea", {\n    id: "announcement-title",\n    className: "input-field mt-2 textarea-expand w-100",\n    rows: 1,\n    placeholder: "Title...",\n    "data-category": "input-field",\n    onChange: e => {\n      (0,_utils__WEBPACK_IMPORTED_MODULE_4__.autoResizeTextarea)(e.target);\n    },\n    onInput: e => {\n      handleAnnouncementTextChange(e);\n    }\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("textarea", {\n    id: "break-line-text",\n    className: "input-field mt-2 textarea-expand w-100",\n    rows: 1,\n    placeholder: "Text...",\n    "data-category": "input-field",\n    onChange: e => {\n      (0,_utils__WEBPACK_IMPORTED_MODULE_4__.autoResizeTextarea)(e.target);\n    },\n    onInput: e => {\n      handleAnnouncementTitleChange(e);\n    }\n  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", {\n    className: "custom-modal-footer"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("button", {\n    id: "submit-data",\n    className: "btn btn-primary me-auto rounded-15",\n    onClick: postAnnouncement\n  }, "Post announcement"))));\n}\n\n//# sourceURL=webpack://frontend/./src/components/AnnouncementsPage.js?')},"./src/components/util-components/ProfilePictureLazyLoader.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (/* binding */ ProfilePictureLazyLoader)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction ProfilePictureLazyLoader({\n  format,\n  base64,\n  width,\n  height\n}) {\n  if (!format || !base64) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("span", {\n      className: "fading-circle",\n      style: {\n        width: width,\n        height: height\n      }\n    });\n  }\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("img", {\n    className: "rounded-circle",\n    style: {\n      width: width,\n      height: height\n    },\n    src: `data: image/${format}; base64, ${base64}`,\n    alt: ""\n  });\n}\n\n//# sourceURL=webpack://frontend/./src/components/util-components/ProfilePictureLazyLoader.js?')}}]);