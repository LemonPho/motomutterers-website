"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[631],{631:(e,t,a)=>{a.r(t),a.d(t,{default:()=>R});var n=a(540),o=a(446),r=(a(807),a(974)),c=a(926),l=a(946);function s(){const{createSeasonCompetitor:e,season:t}=(0,o.Q)(),{setModalErrorMessage:a,modalErrorMessage:r,resetApplicationMessages:s}=(0,l.Xn)(),[i,m]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),[p,E]=(0,n.useState)(!1),[g,h]=(0,n.useState)(!1),[f,v]=(0,n.useState)(1),[N,b]=(0,n.useState)(0);function y(e){const t=e.currentTarget.id;"competitor-edit-number"==t||"competitor-create-number"==t?v(e.currentTarget.value):"competitor-edit-points"==t||"competitor-create-points"==t?b(e.currentTarget.value):"competitor-edit-independent"==t||"competitor-create-independent"==t?E(e.currentTarget.checked):"competitor-edit-first"==t||"competitor-create-first"==t?m(e.currentTarget.innerHTML):"competitor-edit-last"==t||"competitor-create-last"==t?u(e.currentTarget.innerHTML):"competitor-edit-rookie"!=t&&"competitor-create-rookie"!=t||h(e.currentTarget.checked)}async function k(){s();let a={first:null,last:null,number:null},n={competitor:a,points:null},o={competitor_points:n,independent:null,rookie:null,season:t.year};a.first=i,a.last=d,a.number=f,n.points=N,n.competitor=a,o.independent=p,o.rookie=g,o.competitor_points=n,await e(o)&&((0,c.tI)(),retrieveSeason())}return n.createElement("div",{className:"custom-modal hidden",id:"competitor-create-manual-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",null,"Create rider")),n.createElement("hr",null),n.createElement("div",{className:"custom-modal-body"},r&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,r)),n.createElement("div",{id:"competitor-create-first",className:"input-field mt-2",contentEditable:!0,"data-placeholder":"First name...","data-category":"input-field",autoFocus:!0,onKeyUp:e=>(0,c.ac)(e,k),onInput:e=>y(e)}),n.createElement("div",{id:"competitor-create-last",className:"input-field mt-2",contentEditable:!0,"data-placeholder":"Last name(s)...","data-category":"input-field",onKeyUp:e=>(0,c.ac)(e,k),onInput:e=>y(e)}),n.createElement("div",{className:"d-flex justify-content-around my-2"},n.createElement("input",{id:"competitor-create-number",className:"input-field flex-grow-1 me-1",type:"number",min:"1",max:"99",step:"1",placeholder:"Number","data-category":"input-field",onChange:e=>y(e),onKeyUp:e=>(0,c.ac)(e,k)}),n.createElement("input",{id:"competitor-create-points",className:"input-field flex-grow-1",type:"number",min:"0",max:"999",step:"1",placeholder:"Points","data-category":"input-field",onChange:e=>y(e),onKeyUp:e=>(0,c.ac)(e,k)})),n.createElement("form",{className:"form-check"},n.createElement("input",{id:"competitor-create-independent",type:"checkbox",className:"form-check-input",value:"","data-category":"input-field",onChange:e=>y(e),onKeyUp:e=>(0,c.ac)(e,k)}),n.createElement("label",{className:"form-check-label ms-1",htmlFor:"competitor-create-independent"},"Independent Rider")),n.createElement("form",{className:"form-check"},n.createElement("input",{id:"competitor-create-rookie",type:"checkbox",className:"form-check-input",value:"","data-category":"input-field",onChange:e=>y(e),onKeyUp:e=>(0,c.ac)(e,k)}),n.createElement("label",{className:"form-check-label ms-1",htmlFor:"competitor-create-rookie"},"Rookie Rider"))),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{id:"competitor-create-button",className:"btn btn-primary me-auto rounded-15",onClick:k},"Create rider")))}var i=a(550);function m(){const{modalErrorMessage:e,setModalErrorMessage:t,loadingMessage:a,setLoadingMessage:r,setSuccessMessage:s,resetApplicationMessages:m}=(0,l.Xn)(),{retrieveSeason:d,season:u}=(0,o.Q)();async function p(){m(),r("Loading...");let e=document.getElementById("competitor-automatic-link").innerHTML;const a=await(0,i.ZR)(e,u.year);r(!1),a.error?t("There was an error processing the riders, try again later"):a.invalidLink?t("Incorrect link, be sure its coppied correctly"):a.invalidSeason?t("Could not find the season in the database"):a.timeout?t("MotoGP website didn't load"):400!=a.status?((0,c.tI)(),d(),s("Riders successfully added")):t("There was an error adding the riders")}return n.createElement("div",{id:"competitor-create-standings-modal",className:"custom-modal hidden",onClick:e=>e.stopPropagation()},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",null,"Create competitor automatic")),n.createElement("hr",null),n.createElement("div",{className:"custom-modal-body"},n.createElement("div",{className:"alert alert-info"},n.createElement("small",null,"Paste the link of the motogp.com standings page")),e&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,e)),a&&n.createElement("div",{className:"alert alert-secondary"},n.createElement("small",null,a)),n.createElement("div",{className:"input-field",id:"competitor-automatic-link",contentEditable:!0,role:"textbox","data-placeholder":"Link...","data-category":"input-field",onClick:e=>{(0,c.Gd)("competitor-automatic-link"),e.stopPropagation()},onKeyUp:e=>{(0,c.ac)(e,p)}})),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{className:"btn btn-primary",onClick:p},"Submit")))}function d(){const{modalErrorMessage:e,setModalErrorMessage:t,resetApplicationMessages:a,setLoadingMessage:r,loadingMessage:d,setSuccessMessage:u}=(0,l.Xn)(),{retrieveSeason:p,season:E}=(0,o.Q)();return n.createElement("div",{className:"ms-auto"},n.createElement("div",{className:"custom-modal hidden",id:"competitor-create-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-body"},e&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,e)),d&&n.createElement("div",{className:"alert alert-secondary"},n.createElement("small",null,d)),n.createElement("div",{className:"card rounded-15 clickable mb-2",onClick:e=>{a(),(0,c.YK)("competitor-create-standings-modal",e)}},n.createElement("div",{className:"card-body"},n.createElement("div",{className:"d-flex justify-content-center"},n.createElement("strong",null,"Retrieve season competitors through motogp standings page")))),n.createElement("div",{className:"card rounded-15 clickable mb-2",onClick:async function(){a(),r("Loading...");const e=await(0,i.ZR)("https://www.motogp.com/en/riders/motogp",E.year);r(!1),e.error?t("There was an error processing the riders, try again later"):e.invalidLink?t("Incorrect link, be sure its coppied correctly"):e.invalidSeason?t("Could not find the season in the database"):e.timeout?t("MotoGP website didn't load"):400!=e.status?((0,c.tI)(),p(),u("Riders successfully added")):t("There was an error adding the riders")}},n.createElement("div",{className:"card-body"},n.createElement("div",{className:"d-flex justify-content-center"},n.createElement("strong",null,"Retrieve season competitors through motogp rider list")))),n.createElement("div",{className:"card rounded-15 clickable",onClick:e=>{a(),(0,c.YK)("competitor-create-manual-modal",e)}},n.createElement("div",{className:"card-body"},n.createElement("div",{className:"d-flex justify-content-center"},n.createElement("strong",null,"Create competitor manually")))))),n.createElement(m,null),n.createElement(s,null))}function u(){const{setLoadingMessage:e,setModalErrorMessage:t,setSuccessMessage:a,modalErrorMessage:r,loadingMessage:s}=(0,l.Xn)(),{season:m,retrieveSeason:d}=(0,o.Q)();return n.createElement("div",{className:"custom-modal hidden",id:"delete-all-competitors-modal",onClick:e=>{e.stopPropagation()}},r&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,r)),s&&n.createElement("div",{className:"alert alert-secondary"},n.createElement("small",null,s)),n.createElement("div",{className:"custom-modal-body justify-content-center"},n.createElement("h5",null,n.createElement("strong",null,"Are you sure you want to delete all the competitors?"))),n.createElement("hr",null),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{className:"btn btn-danger rounded-15",onClick:async function(){e("Loading...");const n=await(0,i.UH)(m.id);e(!1),n.error||500===n.status?t("There was an error deleting all the competitors"):400!==n.status?404!==n.status?((0,c.tI)(),a("Competitors successfully deleted"),d()):t("Season was not found, please reload and try again"):t("There was an error sending the season data, please reload and try again")}},"Yes"),n.createElement("button",{className:"btn btn-secondary rounded-15 ms-auto",onClick:c.tI},"Cancel")))}function p(){return n.createElement("div",{className:"custom-modal hidden",id:"select-competitors-delete-modal"},n.createElement("div",{className:"custom-modal-body"},"This is the select competitors to delete modal"))}function E(){return n.createElement("div",null,n.createElement("div",{className:"custom-modal hidden",id:"competitor-delete-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"card rounded-15 clickable mb-2",onClick:e=>{(0,c.YK)("delete-all-competitors-modal",e)}},n.createElement("div",{className:"card-body"},n.createElement("div",{className:"d-flex justify-content-center"},n.createElement("strong",null,"Delete all competitors")))),n.createElement("div",{className:"card rounded-15 clickable",onClick:e=>{(0,c.YK)("select-competitors-delete-modal",e)}},n.createElement("div",{className:"card-body"},n.createElement("div",{className:"d-flex justify-content-center"},n.createElement("strong",null,"Select competitors to delete"))))),n.createElement(u,null),n.createElement(p,null))}function g(){const{season:e,seasonLoading:t,createSeasonCompetitor:a,editSeasonCompetitor:s,deleteSeasonCompetitor:i,retrieveSeason:m}=(0,o.Q)(),{resetApplicationMessages:u,modalErrorMessage:p,setModalErrorMessage:g,loadingMessage:h,setLoadingMessage:f,setSuccessMessage:v}=(0,l.Xn)(),[N,b]=(0,n.useState)({}),[y,k]=(0,n.useState)(0),[w,C]=(0,n.useState)(0),[S,M]=(0,n.useState)(""),[x,T]=(0,n.useState)(""),[L,_]=(0,n.useState)(!1),[R,K]=(0,n.useState)(!1);function I(e){const t=e.currentTarget.id;"competitor-edit-number"==t||"competitor-create-number"==t?k(e.currentTarget.value):"competitor-edit-points"==t||"competitor-create-points"==t?C(e.currentTarget.value):"competitor-edit-independent"==t||"competitor-create-independent"==t?_(e.currentTarget.checked):"competitor-edit-first"==t||"competitor-create-first"==t?M(e.currentTarget.innerHTML):"competitor-edit-last"==t||"competitor-create-last"==t?T(e.currentTarget.innerHTML):"competitor-edit-rookie"!=t&&"competitor-create-rooie"!=t||K(e.currentTarget.checked)}async function P(){u();let e={id:null,first:null,last:null,number:null},t={competitor:e,points:null,id:null},a={id:null,competitorPoints:t,independent:null,rookie:null};e.first=S,e.last=x,e.number=y,e.id=N.competitor_points.competitor.id,t.points=w,t.id=N.competitor_points.id,a.id=N.id,a.competitorPoints=t,a.independent=L,a.rookie=R,await s(a)?(0,c.tI)():g("There was an error while submiting the edited competitor")}return t?n.createElement("div",{className:"p-3"},"Loading..."):n.createElement("div",null,n.createElement("div",{className:"card-header rounded-15-top"},n.createElement("div",{className:"container",style:{paddingLeft:"0px",paddingRight:"0px"}},n.createElement("div",{className:"d-flex"},n.createElement("h3",null,"Riders"),!e.finalized&&n.createElement("div",{className:"ms-auto"},n.createElement("button",{className:"btn",id:"create-competitor-button",onClick:e=>(0,c.YK)("competitor-create-modal",e)},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"blue",className:"bi bi-plus",viewBox:"0 0 16 16"},n.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"}))),n.createElement("button",{className:"btn"},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"red",className:"bi bi-trash",viewBox:"0 0 16 16",onClick:e=>(0,c.YK)("competitor-delete-modal",e)},n.createElement("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),n.createElement("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"}))))))),n.createElement("div",{className:"card-body",style:{padding:"0.5rem"}},n.createElement("div",{className:"container mb-2"},0!=e.competitors.length&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-1"},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",fill:"currentColor",className:"bi bi-pen",viewBox:"0 0 16 16"},n.createElement("path",{d:"m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001m-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708z"}))),n.createElement("span",{className:"col-5"},"Name"),n.createElement("span",{className:"col-3"},"#"),n.createElement("span",{className:"col-3"},"Points")),e.competitors.map((e=>n.createElement("div",{className:"row",key:`competitor-${e.id}`},n.createElement("div",{id:"edit-competitor-button",className:"ms-auto dropdown-div col-1 d-flex align-items-center",onClick:t=>async function(e,t){u(),(0,c.YK)("competitor-edit-modal",t);const a=await(0,r.Si)(e);if(a.error)return g("There was an error editing the rider"),void console.log(a.error);404!=a.status?200==a.status?(b(a.competitor),k(a.competitor.competitor_points.competitor.number),C(a.competitor.competitor_points.points),M(a.competitor.competitor_points.competitor.first),T(a.competitor.competitor_points.competitor.last),_(a.competitor.independent),K(a.competitor.rookie),document.getElementById("competitor-edit-first").innerHTML=a.competitor.competitor_points.competitor.first,document.getElementById("competitor-edit-last").innerHTML=a.competitor.competitor_points.competitor.last):g("Be sure the rider number is unique to this season"):g("Rider was not found in the database")}(e.id,t)},n.createElement("div",null,n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-three-dots-vertical",viewBox:"0 0 16 16"},n.createElement("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"})))),n.createElement("span",{className:"col-5"},e.competitor_points.competitor.first," ",e.competitor_points.competitor.last),n.createElement("span",{className:"col-3"},e.competitor_points.competitor.number),n.createElement("span",{className:"col-3"},e.competitor_points.points)))))),n.createElement(d,null),n.createElement(E,null),n.createElement("div",{className:"custom-modal hidden",id:"competitor-edit-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",null,"Edit rider")),p&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,p)),n.createElement("hr",null),n.createElement("div",{className:"custom-modal-body"},n.createElement("div",{id:"competitor-edit-first",className:"input-field mt-2",contentEditable:!0,"data-placeholder":"First name...","data-category":"input-field",onKeyUp:e=>(0,c.ac)(e,P),onInput:e=>I(e)}),n.createElement("div",{id:"competitor-edit-last",className:"input-field mt-2",contentEditable:!0,"data-placeholder":"Last name(s)...","data-category":"input-field",onKeyUp:e=>(0,c.ac)(e,P),onInput:e=>I(e)}),n.createElement("div",{className:"d-flex justify-content-around mt-2"},n.createElement("input",{id:"competitor-edit-number",className:"input-field flex-grow-1 me-1",type:"number",min:"1",max:"99",step:"1",placeholder:"Number",value:y,"data-category":"input-field",onChange:e=>I(e),onKeyUp:e=>(0,c.ac)(e,P)}),n.createElement("input",{id:"competitor-edit-points",className:"input-field flex-grow-1",type:"number",min:"0",max:"999",step:"1",placeholder:"Points",value:w,"data-category":"input-field",onChange:e=>I(e),onKeyUp:e=>(0,c.ac)(e,P)})),n.createElement("form",{className:"form-check"},n.createElement("input",{id:"competitor-edit-independent",type:"checkbox",className:"form-check-input",checked:L,"data-category":"input-field",onChange:e=>I(e),onKeyUp:e=>(0,c.ac)(e,P)}),n.createElement("label",{className:"form-check-label ms-1",htmlFor:"competitor-edit-independent"},"Independent Rider")),n.createElement("form",{className:"form-check"},n.createElement("input",{id:"competitor-edit-rookie",type:"checkbox",className:"form-check-input",checked:R,"data-category":"input-field",onChange:e=>I(e),onKeyUp:e=>(0,c.ac)(e,P)}),n.createElement("label",{className:"form-check-label ms-1",htmlFor:"competitor-edit-rookie"},"Rookie"))),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{id:"competitor-edit-button",className:"btn btn-primary me-auto rounded-15",onClick:P},"Save Changes"),n.createElement("button",{id:"competitor-delete-button",className:"btn btn-danger ms-auto rounded-15",onClick:()=>async function(t){u(),await i(t,e.id)&&(0,c.tI)()}(N.id)},"Delete Rider"))))}function h(){const{modalErrorMessage:e,setModalErrorMessage:t,setSuccessMessage:a,setLoadingMessage:r,loadingMessage:s,resetApplicationMessages:m}=(0,l.Xn)(),{season:d,retrieveSeason:u}=(0,o.Q)(),[p,E]=(0,n.useState)();async function g(){m(),r("Loading...");let e=document.getElementById("race-automatic-link").innerHTML,n=await(0,i.TR)(e,p,d.year);if(r(!1),console.log(n),n.error)return t("There was an error processing the link."),void console.log(n.error);if(n.invalidLink)t("The link is invalid or website didn't load.");else{if(n.competitorNumbersNotFound.length>0){let e="Competitors with the numbers: ";for(let t=0;t<n.competitorNumbersNotFound.length;t++)e+=String(n.competitorNumbersNotFound[t]),e+=" ";return e+="were not found in the database",void t(e)}n.timeout?t("Motosport website didn't load, try again later"):n.invalidSeason?t("Season was not found in the database"):201==n.status?((0,c.tI)(),r(!1),a("The race has been submited"),u()):t("There was an error processing the link.")}}return n.createElement("div",{className:"custom-modal hidden",id:"race-create-automatic-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",null,"Create Race Automatic")),n.createElement("hr",null),n.createElement("div",{className:"custom-modal-body"},e&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,e)),s&&n.createElement("div",{className:"alert alert-secondary"},n.createElement("small",null,s)),n.createElement("div",{className:"alert alert-info"},n.createElement("small",null,"Open the race result on motorsport.com and then paste the link into the textbox")),n.createElement("div",{className:"input-field",id:"race-automatic-link",contentEditable:!0,role:"textbox","data-placeholder":"Link...","data-category":"input-field",onClick:e=>{(0,c.Gd)("race-automatic-link"),e.stopPropagation()},onKeyUp:e=>{(0,c.ac)(e,g)}}),n.createElement("div",{className:"d-flex justify-content-center align-items-center mt-2"},n.createElement("input",{id:"race-automatic-date",type:"date",className:"input-field","data-category":"input-field",onChange:e=>function(e){const t=e.target.value;E(t)}(e),onKeyUp:e=>{(0,c.ac)(e,g)}}))),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{className:"btn btn-primary rounded-15",onClick:g},"Submit")))}const f=(0,n.createContext)();function v({children:e}){const[t,a]=(0,n.useState)(""),[r,s]=(0,n.useState)(""),[m,d]=(0,n.useState)(""),[u,p]=(0,n.useState)(!1),[E,g]=(0,n.useState)([]),[h,v]=(0,n.useState)([]),[N,b]=(0,n.useState)([]),{setModalErrorMessage:y,setSuccessMessage:k}=(0,l.Xn)(),{season:w,retrieveSeason:C}=(0,o.Q)();return n.createElement(f.Provider,{value:{track:t,title:r,timestamp:m,isSprint:u,setTrack:a,setTitle:s,setIsSprint:p,setTimestamp:d,setSelectedCompetitors:g,setCompetitorsPositions:v,competitorsPositions:h,selectedCompetitors:E,createRace:async function(){b([]);let e={race:{title:r,track:t,timestamp:m,is_sprint:u,finalized:!0},competitors_positions:h},n=await(0,i.jl)(e,w.year);return n.error?(console.log(n),void y("There was an error submiting the race")):n.competitorsNotFound.includes(!0)?(y("Highlighted competitors were not found in the database"),void b(n.competitorsNotFound)):0!=n.invalidCompetitorsPositionsSpacing.length?(y("Highlighted competitors have invalid spacing (positions) between them"),void b(n.invalidCompetitorsPositionsSpacing)):void(n.invalidCompetitorsPositions?y("Some or all competitor positions could not be created"):n.invalidSeason?y("There was an error retrieving the season from the database or it doesn't exist"):n.invalidRaceData?y("Some or all of the details of the race are bad (title, track, date, etc)"):400!==n.status?(a(""),s(""),d(""),p(""),g([]),v([]),b([]),k("Race successfully added"),(0,c.tI)(),C()):y("There was an error submiting the race"))},invalidCompetitors:N}},e)}function N(){return(0,n.useContext)(f)}function b(){const{modalErrorMessage:e,loggedIn:t,user:a}=(0,l.Xn)(),{track:o,title:r,timestamp:s,isSprint:i,setTrack:m,setTitle:d,setTimestamp:u,setIsSprint:p}=N(),[E,g]=(0,n.useState)(!1);function h(e){""!=o&&""!=r&&0!=s?(0,c.YK)("competitors-select-modal",e,t,a.is_admin):g(!0)}return n.createElement("div",{className:"custom-modal hidden",id:"create-race-details-manual-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",null,"Race Details")),e&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,e)),E&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,"Make sure all the fields are filled in")),n.createElement("hr",null),n.createElement("div",{className:"custom-modal-body"},n.createElement("div",{id:"race-create-track",className:"input-field mt-2",contentEditable:!0,"data-placeholder":"Track name...",onKeyUp:e=>{(0,c.ac)(e,h),function(e){m(e.currentTarget.innerHTML)}(e)}}),n.createElement("div",{id:"race-create-title",className:"input-field mt-2",contentEditable:!0,"data-placeholder":"Race title...",onKeyUp:e=>{(0,c.ac)(e,h),function(e){d(e.currentTarget.innerHTML)}(e)}}),n.createElement("div",{className:"d-flex justify-content-center"},n.createElement("input",{id:"race-create-date",type:"date",className:"input-field flex-grow-1 mt-2",onChange:e=>function(e){u(e.currentTarget.value)}(e),onKeyUp:e=>(0,c.ac)(e,h)})),n.createElement("div",{className:"form-check mt-1"},n.createElement("input",{id:"race-create-sprint",type:"checkbox",className:"form-check-input",value:s,onChange:e=>function(e){p(e.currentTarget.checked)}(e),onKeyUp:e=>(0,c.ac)(e,h)}),n.createElement("label",{className:"form-check-label",htmlFor:"race-create-sprint"},"Sprint Race"))),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{className:"btn btn-primary rounded-15 ms-auto",onClick:e=>{h(e)}},"Next")))}function y(){const{season:e,seasonLoading:t}=(0,o.Q)(),{modalErrorMessage:a,loggedIn:r,user:s}=(0,l.Xn)(),{createRace:i,invalidCompetitors:m,selectedCompetitors:d,competitorsPositions:u,setCompetitorsPositions:p}=N(),[E,g]=(0,n.useState)([]),[h,f]=(0,n.useState)(!0);function v(e,t){let a=u;a[t].position=Number(e.currentTarget.value),p(a)}if((0,n.useEffect)((()=>{f(!0),function(){g(d);const e=d.map((e=>({competitor_id:e.competitor_points.competitor.id,position:0})));p(e)}(),f(!1)}),[d]),!t&&!h)return n.createElement("div",{className:"custom-modal hidden",id:"race-results-create-manual-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",null,"Race Create Manual")),n.createElement("div",{className:"alert alert-info"},n.createElement("small",null,"Input the final positions of the riders, 0 for DNF")),a&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,a)),n.createElement("hr",null),n.createElement("div",{className:"custom-modal-body"},0!=E.length&&E.map(((e,t)=>n.createElement("div",{key:`competitor-position-form-${e.competitor_points.competitor.number}`,className:"mb-1"},0!=m.length&&m.some((t=>t==e.competitor.id))?n.createElement("form",null,n.createElement("input",{className:"input-field me-2",id:`competitor-position-${e.competitor_points.competitor.number}`,type:"number",max:99,min:0,defaultValue:0,onChange:e=>v(e,t)}),n.createElement("label",{className:"text-danger",htmlFor:`competitor-position-${e.competitor_points.competitor.number}`},"#",e.competitor_points.competitor.number," ",e.competitor_points.competitor.first," ",e.competitor_points.competitor.last)):n.createElement("form",null,n.createElement("input",{className:"input-field me-2",id:`competitor-position-${e.competitor_points.competitor.number}`,type:"number",max:99,min:0,defaultValue:0,onChange:e=>v(e,t)}),n.createElement("label",{htmlFor:`competitor-position-${e.competitor_points.competitor.number}`},"#",e.competitor_points.competitor.number," ",e.competitor_points.competitor.first," ",e.competitor_points.competitor.last)))))),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{className:"btn btn-primary rounded-15",onClick:e=>{(0,c.YK)("competitors-select-modal",e,r,s.is_admin)}},"Back"),n.createElement("button",{className:"btn btn-primary rounded-15 ms-auto",onClick:async function(){let e=u;e.sort(((e,t)=>e.position-t.position)),p(e),await i()}},"Save race result")))}function k(){const[e,t]=(0,n.useState)([]),{season:a}=(0,o.Q)(),{modalErrorMessage:r,loggedIn:s,user:i}=(0,l.Xn)(),{setSelectedCompetitors:m}=N();return(0,n.useEffect)((()=>{const e=a.competitorsSortedNumber.map((e=>({competitor:e,include:!0})));t(e)}),[]),n.createElement("div",{className:"custom-modal hidden",id:"competitors-select-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",null,"Select the riders that participated in the race")),r&&n.createElement("div",{className:"alert alert-danger my-3"},r),n.createElement("hr",null),n.createElement("div",{className:"custom-modal-body"},0!=e.length&&e.map(((t,a)=>n.createElement("div",{className:"form-check",key:`competitor-checkbox-${t.competitor.id}`,id:`competitor-checkbox-${t.competitor.id}`},n.createElement("input",{className:"form-check-input",type:"checkbox",defaultChecked:e[a].include,onChange:()=>{e[a].include=!e[a].include},id:`include-competitor-${t.competitor.competitor_points.competitor.id}`}),n.createElement("label",{className:"form-check-label",htmlFor:`include-competitor-${t.competitor.competitor_points.competitor.id}`},"#",t.competitor.competitor_points.competitor.number," ",t.competitor.competitor_points.competitor.first," ",t.competitor.competitor_points.competitor.last))))),n.createElement("div",{className:"custom-modal-footer mt-2"},n.createElement("button",{className:"btn btn-primary rounded-15",onClick:e=>{(0,c.YK)("create-race-details-manual-modal",e,s,i.is_admin)}},"Back"),n.createElement("button",{className:"btn btn-primary ms-auto rounded-15",onClick:t=>{!function(t){let a=[];for(let t=0;t<e.length;t++)e[t].include&&a.push(e[t].competitor);m(a),(0,c.YK)("race-results-create-manual-modal",t,s,i.is_admin)}(t)}},"Next")))}function w(){const{modalErrorMessage:e,contextLoading:t,loggedIn:a,user:r}=(0,l.Xn)(),{season:c,seasonLoading:s}=(0,o.Q)();if(!s&&!t)return n.createElement("div",null,n.createElement(b,null),n.createElement(y,null),n.createElement(k,null),n.createElement(y,null))}function C(){const{season:e,seasonLoading:t}=(0,o.Q)(),{modalErrorMessage:a,setModalErrorMessage:r,resetApplicationMessages:s,loggedIn:i,user:m}=(0,l.Xn)(),[d,u]=(0,n.useState)((()=>{if(!t)return 0!=e.competitors.length}));return n.createElement("div",{className:"ms-auto"},n.createElement("div",{className:"custom-modal hidden",id:"race-create-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",null,"Create Race")),!d&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,"You need to have competitors added to create a race")),d&&n.createElement("div",null,a&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,a)),n.createElement("div",{className:"custom-modal-body"},n.createElement("div",{className:"card rounded-15 clickable mb-2",onClick:e=>{s(),(0,c.YK)("race-create-automatic-modal",e,i,m.is_admin)}},n.createElement("div",{className:"card-body"},n.createElement("div",{className:"d-flex justify-content-center"},n.createElement("strong",null,"Create race automatically with motorsport link")))),n.createElement("div",{className:"card rounded-15 clickable",onClick:e=>{s(),(0,c.YK)("create-race-details-manual-modal",e,i,m.is_admin)}},n.createElement("div",{className:"card-body"},n.createElement("div",{className:"d-flex justify-content-center"},n.createElement("strong",null,"Create race manually"))))))),n.createElement(h,null),n.createElement(v,null,n.createElement(w,null)))}const S=(0,n.createContext)();function M({children:e,raceId:t}){const{setModalErrorMessage:a,setSuccessMessage:s,resetApplicationMessages:m}=(0,l.Xn)(),{retrieveSeason:d}=(0,o.Q)(),[u,p]=(0,n.useState)(""),[E,g]=(0,n.useState)(""),[h,f]=(0,n.useState)(""),[v,N]=(0,n.useState)(!1),[b,y]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{!async function(){y(!0),await async function(){if(m(),null==t)return;const e=await(0,r.YY)(t);200==e.status||201==e.status?(p(e.race.track),g(e.race.title),f(e.race.timestamp),N(e.race.is_sprint)):a("There was an error retrieving the race data")}(),y(!1)}()}),[t]),n.createElement(S.Provider,{value:{track:u,title:E,timestamp:h,isSprint:v,setTrack:p,setTitle:g,setTimestamp:f,setIsSprint:N,editRace:async function(){m();const e={title:E,track:u,timestamp:h,isSprint:v,id:t},n=await(0,i._O)(e);n.error||201!=n.status?a("There has been an error editing the race, make sure the data inputted is correct"):(s("Race edited"),d(),(0,c.tI)(),p(""),g(""),f(""),N(!1))},raceEditLoading:b}},e)}function x(){const{modalErrorMessage:e}=(0,l.Xn)(),{track:t,title:a,isSprint:o,timestamp:r,setTrack:s,setTitle:i,setIsSprint:m,setTimestamp:d,editRace:u,raceEditLoading:p}=(0,n.useContext)(S);async function E(){await u()}return(0,n.useEffect)((()=>{p||""!=t&&""!=a&&(document.getElementById("race-edit-track").innerHTML=t,document.getElementById("race-edit-title").innerHTML=a)}),[p]),n.createElement("div",{className:"custom-modal hidden",id:"race-edit-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",null,"Edit Race")),n.createElement("hr",null),e&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,e)),n.createElement("div",{className:"custom-modal-body"},n.createElement("div",{id:"race-edit-track",className:"input-field mt-2",contentEditable:!0,"data-placeholder":"Track name...",onKeyUp:e=>{(0,c.ac)(e,E),s(e.currentTarget.innerHTML)}}),n.createElement("div",{id:"race-edit-title",className:"input-field mt-2",contentEditable:!0,"data-placeholder":"Race title...",onKeyUp:e=>{(0,c.ac)(e,E),i(e.currentTarget.innerHTML)}}),n.createElement("div",{className:"d-flex justify-content-center"},n.createElement("input",{id:"race-edit-date",type:"date",className:"input-field flex-grow-1 mt-2",value:r,onChange:e=>d(e.currentTarget.value),onKeyUp:e=>(0,c.ac)(e,E)})),n.createElement("div",{className:"form-check mt-1"},n.createElement("input",{id:"race-edit-sprint",type:"checkbox",className:"form-check-input",checked:o,onChange:()=>{m(!o),console.log(o)},onKeyUp:e=>(0,c.ac)(e,E)}),n.createElement("label",{className:"form-check-label",htmlFor:"race-edit-sprint"},"Sprint Race"))),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{className:"btn btn-primary ms-auto",onClick:E},"Save changes")))}function T(){const{season:e,seasonLoading:t,retrieveSeason:a,editSeasonRace:s,deleteSeasonRace:i,createSeasonRace:m,addSeasonRaceResults:d}=(0,o.Q)(),{modalErrorMessage:u,setModalErrorMessage:p,resetApplicationMessages:E,loggedIn:g,user:h,successMessage:f}=(0,l.Xn)(),[v,N]=(0,n.useState)(null),[b,y]=(0,n.useState)(null),[k,w]=(0,n.useState)(!1);async function S(e,t){const a=await(0,r.YY)(t);if(a.error||200!=a.status)return console.log(a),void p("There was an error loading the race");w(a.race),(0,c.YK)("race-result-modal",e,g,h.is_admin)}return(0,n.useEffect)((()=>{"Race edited"==f&&N(null)}),[f]),t?n.createElement("div",{className:"p-3"},"Loading..."):n.createElement("div",null,n.createElement(C,null),n.createElement(M,{raceId:v},n.createElement(x,null)),n.createElement("div",{className:"custom-modal hidden",id:"race-result-modal"},n.createElement("div",{className:"custom-modal-header"},k&&n.createElement("h5",null,k.title)),u&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,u)),n.createElement("hr",null),n.createElement("div",{className:"custom-modal-body"},n.createElement("div",null,n.createElement("div",{className:"row g-0",style:{marginRight:"0px",padding:"0px"}},n.createElement("strong",{className:"col-2"},"Pos."),n.createElement("strong",{className:"col-6"},"Name")),k&&k.competitors_positions.map((e=>n.createElement("div",{className:"row g-0",key:`competitor-${e.competitor_points.competitor.id}`,style:{marginRight:"0px"}},0==e.position&&n.createElement("span",{className:"col-2"},"DNF"),0!=e.position&&n.createElement("span",{className:"col-2"},e.position),n.createElement("span",{className:"col-6"},n.createElement("small",null,"#",e.competitor_points.competitor.number)," ",e.competitor_points.competitor.first," ",e.competitor_points.competitor.last))))))),n.createElement("div",{className:"card-header rounded-15-top"},n.createElement("div",{className:"container",style:{paddingLeft:"0px",paddingRight:"0px"}},n.createElement("div",{className:"d-flex"},n.createElement("h3",null,"Races"),!e.finalized&&n.createElement("button",{className:"btn ms-auto",id:"create-race-button",onClick:e=>{E(),(0,c.YK)("race-create-modal",e,g,h.is_admin)}},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"blue",className:"bi bi-plus",viewBox:"0 0 16 16"},n.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"})))))),n.createElement("div",{className:"card-body"},e.races.map((e=>n.createElement("div",{className:"container card rounded-15 clickable my-1",id:`race-${e.id}`,key:`race-${e.id}`,onClick:t=>S(t,e.id)},n.createElement("div",{className:"d-flex align-items-center"},n.createElement("div",{className:"container",style:{padding:"0px"}},n.createElement("div",null,e.title," ",e.is_sprint&&n.createElement("span",null,"(sprint)")),n.createElement("small",null,n.createElement("strong",null,e.timestamp))),e.finalized&&n.createElement("span",{className:"badge rounded-pill text-bg-success ms-auto clickable",onClick:t=>{S(t,e.id)}},"Final"),!e.finalized&&n.createElement("span",{className:"badge rounded-pill text-bg-secondary ms-auto clickable",onClick:t=>{openSelectCompetitorsModal(t),setTempRaceId(e.id)}},"Upcoming"),n.createElement("div",{className:"dropdown-div",onClick:t=>(0,c.gR)(`dropdown-race-${e.id}`,t)},n.createElement("div",{className:"d-flex align-items-center"},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-three-dots-vertical",viewBox:"0 0 16 16"},n.createElement("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"}))),n.createElement("ul",{id:`dropdown-race-${e.id}`,className:"dropdown-menu"},n.createElement("li",null,n.createElement("button",{id:"edit-race-button",className:"dropdown-item",onClick:t=>{N(e.id),(0,c.YK)("race-edit-modal",t,g,h.is_admin)}},"Edit")),!e.finalized&&n.createElement("li",null,n.createElement("button",{id:"add-results-race-button",className:"dropdown-item",onClick:e=>{openSelectCompetitorsModal(e)}},"Add Results")),e.finalized&&n.createElement("li",null,n.createElement("button",{id:"view-race-results-button",className:"dropdown-item",onClick:t=>S(t,e.id)},"View Race Results")),n.createElement("li",null,n.createElement("button",{className:"dropdown-item",onClick:()=>i(e.id)},"Delete"))))))))))}function L(){const{season:e}=(0,o.Q)(),{setErrorMessage:t,setSuccessMessage:a,selectPicksState:r,contextLoading:c,retrievePicksState:s}=(0,l.Xn)(),[m,d]=(0,n.useState)(r);if(!c)return n.createElement("div",{className:"d-flex align-items-center w-100"},n.createElement("strong",null,"Enable member picks"),!e.finalized&&n.createElement("div",{className:"form-check form-switch ms-auto mb-0"},n.createElement("input",{className:"form-check-input",type:"checkbox",checked:m,onChange:async function(){if(0==e.competitors.length)return void t("Be sure to have competitors added before enabling member picks");const n=await(0,i.Qz)();if(!n.error)return 200===n.status?(a(`Member picks successfully ${r?"disabled":"enabled"}.`),d(!r),void s()):void t("It was not possible to enable member picks");t("There was an error toggling the member picks.")}})),e.finalized&&n.createElement("div",{className:"form-check form-switch ms-auto mb-0"},n.createElement("input",{className:"form-check-input",type:"checkbox",checked:m,disabled:!0})))}function _(){const{season:e}=(0,o.Q)(),{setErrorMessage:t,setSuccessMessage:a,selectPicksState:r,contextLoading:s}=(0,l.Xn)(),[m,d]=(0,n.useState)(e.finalized);return s?null:n.createElement("div",{className:"d-flex align-items-center w-100"},n.createElement("strong",null,"Finalize Season"),m&&n.createElement("div",{className:"form-check form-switch ms-auto mb-0"},n.createElement("input",{className:"form-check-input",type:"checkbox",checked:m,disabled:!0})),!m&&n.createElement("div",{className:"form-check form-switch ms-auto mb-0"},n.createElement("input",{className:"form-check-input",type:"checkbox",checked:m,onChange:e=>{(0,c.YK)("finalize-season-modal",e)}})),n.createElement("div",{className:"custom-modal hidden",id:"finalize-season-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",null,"Are you sure you want to finalize the season? This can't be reversed")),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{className:"btn btn-danger",onClick:n=>{!async function(){const n=await(0,i.ou)(e.year);if(!n.error)return 200==n.status?(a("Successfully finalized the season"),void d(!0)):void t("There was a problem finalizing the season");t("There was an error finalizing the season")}(),(0,c.YK)("finalize-season-modal",n)}},"Finalize"),n.createElement("button",{className:"ms-auto btn btn-primary",onClick:e=>{(0,c.YK)("finalize-season-modal",e)}},"Cancel"))))}function R(){const{retrieveSeason:e,season:t,seasonLoading:a}=(0,o.Q)(),{contextLoading:r,user:c}=(0,l.Xn)();return(0,n.useEffect)((()=>{e()}),[]),(a||r||!t)&&c.is_admin?n.createElement("div",{className:"container",style:{padding:"0px"}},n.createElement("div",{className:"row"},n.createElement("div",{className:"card rounded-15 col-md me-2 mt-2"},"Loading..."),n.createElement("div",{className:"card rounded-15 col-md mt-2"},"Loading...")),n.createElement("div",{className:"row"},n.createElement("div",{className:"card rounded-15 col-md my-2"},"Loading..."))):c.is_admin?n.createElement("div",null,n.createElement("div",{className:"container",style:{padding:"0px"}},n.createElement("div",{className:"row"},n.createElement("div",{className:"card rounded-15 col-md me-2 mt-2",style:{padding:"0px"}},n.createElement(g,null)),n.createElement("div",{className:"card rounded-15 col-md mt-2",style:{padding:"0px"}},n.createElement(T,null))),n.createElement("div",{className:"row"},n.createElement("div",{className:"card rounded-15 col-md my-2",style:{padding:"10px"}},n.createElement("div",{className:"ps-1"},n.createElement(L,null)),n.createElement("hr",null),n.createElement("div",{className:"ps-1"},n.createElement(_,null)))))):void 0}}}]);