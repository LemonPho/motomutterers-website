"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[788],{788:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var n=t(540),r=t(767),s=t(946),l=t(974),c=t(398),m=t(926),i=t(447);function o(){const[e,a]=(0,n.useState)([]),[t,o]=(0,n.useState)(!0),[d,u]=(0,n.useState)(0),{user:g,userLoading:p,setErrorMessage:h,setSuccessMessage:f,resetApplicationMessages:E,setLoadingMessage:N}=(0,s.Xn)(),[b,v]=(0,n.useState)(!1),[w,k]=(0,n.useState)(1),[y,x]=(0,n.useState)(""),[$,S]=(0,n.useState)(""),[_,C]=(0,n.useState)([]),A=(0,r.zy)(),[I,P]=(0,n.useState)(""),[L,T]=(0,n.useState)("");async function M(){let e=new URLSearchParams(A.search).get("page");k(e);const t=await(0,l.jP)(e);if(t.error||200!==t.status)return h("There was an error while loading the announcements"),void console.log(t.error);a(t.announcements),u(t.amountAnnouncements)}return(0,n.useEffect)((()=>{let e=(0,m.X$)(d,10,w);null!==e&&(S(e.nextPage),x(e.previousPage),C(e.pageNumbers),v(!0))}),[d]),(0,n.useEffect)((()=>{M(),o(!1)}),[]),n.createElement("div",{className:"card element-background-color element-border-color rounded-15"},n.createElement("div",{className:"card-header d-flex align-items-center"},n.createElement("h5",null,"Announcements"),!p&&g.is_admin&&n.createElement("button",{className:"btn btn-primary ms-auto rounded-15",onClick:e=>{P(""),T(""),(0,m.YK)("announcement-create-modal",e,void 0,g.is_admin)}},"Create Announcement")),n.createElement("div",{className:"card-body"},!t&&0!=e.length&&e.map((e=>n.createElement("a",{className:"clickable card mx-auto my-3 rounded-15 element-background-color link-no-decorations",href:`/announcements/${e.id}`,key:e.id},n.createElement("div",{className:"card-header d-flex align-items-center"},n.createElement(i.A,{width:"2rem",height:"2rem",format:e.user.profile_picture_format,base64:e.user.profile_picture_data}),n.createElement("small",{className:"ms-2"},e.user.username),n.createElement("small",{className:"ms-auto"},new Date(e.date_created).toISOString().substring(0,10))),n.createElement("div",{className:"card-body announcement-card-body"},n.createElement("h5",null,e.title),n.createElement("span",null,e.text)),n.createElement("div",{className:"card-footer"},n.createElement("small",null,"Comments: ",e.amount_comments)))))),n.createElement("div",{className:"card-footer"},b&&n.createElement("nav",{id:"pagination-view "},n.createElement("ul",{className:"pagination justify-content-center"},n.createElement("li",{id:"previous-page",className:`${y}`},n.createElement("a",{id:"previous-page-link",href:"announcements?page="+(parseInt(w)-1),className:"page-link"},"Previous")),_.map((e=>parseInt(w)!==e?n.createElement("li",{id:`page-${e}`,key:`page-${e}`,className:"page-item"},n.createElement("a",{id:`page-link-${e}`,href:`announcements?page=${e}`,className:"page-link"},e)):n.createElement("li",{id:`page-${e}`,key:`page-${e}`,className:"page-item disabled"},n.createElement("a",{id:`page-link-${e}`,href:`announcements?page=${e}`,className:"page-link"},e)))),n.createElement("li",{id:"next-page",className:`${$}`},n.createElement("a",{id:"next-page-link",href:`announcements?page=${parseInt(w)+1}`,className:"page-link"},"Next"))))),n.createElement("div",{className:"custom-modal hidden",id:"announcement-create-modal",style:{width:"50%"},onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",{className:"m-0"},"Create announcement")),n.createElement("div",{className:"custom-modal-body"},n.createElement("hr",{className:"m-1"}),n.createElement("div",{className:"d-flex align-items-center"},!p&&n.createElement("img",{className:"rounded-circle",style:{width:"3rem",height:"3rem",marginRight:"0.5rem"},src:`data: image/${g.profile_picture_format}; base64, ${g.profile_picture_data}`,alt:""}),!p&&n.createElement("strong",null,g.username)),n.createElement("textarea",{id:"announcement-title",className:"input-field mt-2 textarea-expand w-100",rows:1,placeholder:"Title...","data-category":"input-field",onChange:e=>{(0,m.QL)(e.target)},onInput:e=>{P(e.target.value)}}),n.createElement("textarea",{id:"break-line-text",className:"input-field mt-2 textarea-expand w-100",rows:1,placeholder:"Text...","data-category":"input-field",onChange:e=>{(0,m.QL)(e.target)},onInput:e=>{T(e.target.value)}})),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{id:"submit-data",className:"btn btn-primary me-auto rounded-15",onClick:async function(){if(E(),N("Loading.."),!g.is_admin)return void h("There was an error submiting the announcement");const e=await(0,c.wS)(L,I);if(e.error)h("There was an error submiting the announcement");else{if(400!==e.status)return 200===e.status?(f("Announcement posted"),N(!1),M(),void(0,m.tI)()):void h("There was a server error while submiting the announcement");h("Be sure the title has less than 128 characters and the text 2048 characters")}}},"Post announcement"))))}},447:(e,a,t)=>{t.d(a,{A:()=>r});var n=t(540);function r({format:e,base64:a,width:t,height:r}){return e&&a?n.createElement("img",{className:"rounded-circle",style:{width:t,height:r},src:`data: image/${e}; base64, ${a}`,alt:""}):n.createElement("span",{className:"fading-circle",style:{width:t,height:r}})}}}]);