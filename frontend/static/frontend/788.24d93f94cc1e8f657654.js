"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[788],{788:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(540),r=a(767),s=a(946),l=a(974),c=a(398),m=a(926);function i(){const[e,t]=(0,n.useState)([]),[a,i]=(0,n.useState)(!0),[o,d]=(0,n.useState)(0),{user:u,userLoading:g,setErrorMessage:p,setSuccessMessage:h,resetApplicationMessages:E,setLoadingMessage:f}=(0,s.Xn)(),[N,b]=(0,n.useState)(!1),[v,k]=(0,n.useState)(1),[y,$]=(0,n.useState)(""),[w,x]=(0,n.useState)(""),[S,_]=(0,n.useState)([]),T=(0,r.zy)();async function C(){let e=new URLSearchParams(T.search).get("page");k(e);const a=await(0,l.jP)(e);if(a.error||200!==a.status)return p("There was an error while loading the announcements"),void console.log(a.error);t(a.announcements),d(a.amountAnnouncements)}return(0,n.useEffect)((()=>{let e=(0,m.X$)(o,10,v);null!==e&&(x(e.nextPage),$(e.previousPage),_(e.pageNumbers),b(!0))}),[o]),(0,n.useEffect)((()=>{C(),i(!1)}),[]),n.createElement("div",{className:"card element-background-color element-border-color rounded-15"},n.createElement("div",{className:"card-header d-flex align-items-center"},n.createElement("h5",null,"Announcements"),!g&&u.is_admin&&n.createElement("button",{className:"btn btn-primary ms-auto rounded-15",onClick:e=>(0,m.YK)("announcement-create-modal",e,void 0,u.is_admin)},"Create Announcement")),n.createElement("div",{className:"card-body"},!a&&0!=e.length&&e.map((e=>n.createElement("div",{className:"clickable card mx-auto my-3 rounded-15 element-background-color",key:e.id},n.createElement("a",{className:"link-no-decorations",href:`/announcements/${e.id}`},n.createElement("div",{className:"p-3",id:`announcement-${e.id}`},n.createElement("div",{className:"d-flex"},n.createElement("small",null,n.createElement("img",{className:"rounded-circle",style:{width:"2rem",height:"2rem",marginRight:"0.5rem"},src:`data: image/${e.user.profile_picture_format}; base64, ${e.user.profile_picture_data}`,alt:""}),e.user.username),n.createElement("small",{className:"ms-auto"},new Date(e.date_created).toISOString().substring(0,10))),n.createElement("div",{className:"d-flex"},n.createElement("h5",{className:"mt-1"},e.title)),n.createElement("hr",{className:"mt-2 mb-1"}),n.createElement("p",null,e.text))))))),n.createElement("div",{className:"card-footer"},N&&n.createElement("nav",{id:"pagination-view "},n.createElement("ul",{className:"pagination justify-content-center"},n.createElement("li",{id:"previous-page",className:`${y}`},n.createElement("a",{id:"previous-page-link",href:"announcements?page="+(parseInt(v)-1),className:"page-link"},"Previous")),S.map((e=>parseInt(v)!==e?n.createElement("li",{id:`page-${e}`,key:`page-${e}`,className:"page-item"},n.createElement("a",{id:`page-link-${e}`,href:`announcements?page=${e}`,className:"page-link"},e)):n.createElement("li",{id:`page-${e}`,key:`page-${e}`,className:"page-item disabled"},n.createElement("a",{id:`page-link-${e}`,href:`announcements?page=${e}`,className:"page-link"},e)))),n.createElement("li",{id:"next-page",className:`${w}`},n.createElement("a",{id:"next-page-link",href:`announcements?page=${parseInt(v)+1}`,className:"page-link"},"Next"))))),n.createElement("div",{className:"custom-modal hidden",id:"announcement-create-modal",style:{width:"50%"},onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",{className:"m-0"},"Create announcement")),n.createElement("div",{className:"custom-modal-body"},n.createElement("hr",{className:"m-1"}),n.createElement("div",{className:"d-flex align-items-center"},!g&&n.createElement("img",{className:"rounded-circle",style:{width:"3rem",height:"3rem",marginRight:"0.5rem"},src:`data: image/${u.profile_picture_format}; base64, ${u.profile_picture_data}`,alt:""}),!g&&n.createElement("strong",null,u.username)),n.createElement("div",{id:"announcement-title",className:"input-field mt-2",contentEditable:!0,"data-placeholder":"Title...","data-category":"input-field"}),n.createElement("div",{id:"break-line-text",className:"input-field mt-2",contentEditable:!0,"data-placeholder":"Text...","data-category":"input-field"})),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{id:"submit-data",className:"btn btn-primary me-auto rounded-15",onClick:async function(){if(E(),f("Loading.."),!u.is_admin)return void p("There was an error submiting the announcement");let e=document.getElementById("announcement-title").innerHTML,t=document.getElementById("break-line-text").innerHTML;const a=await(0,c.wS)(e,t);if(a.error)p("There was an error submiting the announcement");else{if(400!==a.status)return 200===a.status?(h("Announcement posted"),f(!1),C(),void(0,m.tI)()):void p("There was a server error while submiting the announcement");p("Be sure the title has less than 128 characters and the text 2048 characters")}}},"Post announcement"))))}}}]);