"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[788],{788:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var n=t(540),s=t(767),r=t(946),l=t(974),c=t(398),m=t(926),i=t(447);function o(){const[e,a]=(0,n.useState)([]),[t,o]=(0,n.useState)(!0),[u,d]=(0,n.useState)(0),{user:g,userLoading:p,setErrorMessage:h,setSuccessMessage:E,resetApplicationMessages:f,setLoadingMessage:N}=(0,r.Xn)(),[v,b]=(0,n.useState)(!1),[k,w]=(0,n.useState)(1),[x,y]=(0,n.useState)(""),[S,$]=(0,n.useState)(""),[C,A]=(0,n.useState)([]),I=(0,s.zy)(),[P,L]=(0,n.useState)(""),[T,_]=(0,n.useState)("");async function M(){let e=new URLSearchParams(I.search).get("page");w(e);const t=await(0,l.jP)(e);if(t.error||200!==t.status)return h("There was an error while loading the announcements"),void console.log(t.error);a(t.announcements),d(t.amountAnnouncements)}return(0,n.useEffect)((()=>{let e=(0,m.X$)(u,10,k);null!==e&&($(e.nextPage),y(e.previousPage),A(e.pageNumbers),b(!0))}),[u]),(0,n.useEffect)((()=>{M(),o(!1)}),[]),n.createElement("div",{className:"card element-background-color element-border-color rounded-15"},n.createElement("div",{className:"card-header d-flex align-items-center"},n.createElement("h5",null,"Announcements"),!p&&g.is_admin&&n.createElement("button",{className:"btn btn-primary ms-auto rounded-15",onClick:e=>{L(""),_(""),(0,m.YK)("announcement-create-modal",e,void 0,g.is_admin)}},"Create Announcement")),n.createElement("div",{className:"card-body"},!t&&0!=e.length&&e.map((e=>n.createElement("a",{className:"clickable card mx-auto my-3 rounded-15 element-background-color link-no-decorations",href:`/announcements/${e.id}`,key:e.id},n.createElement("div",{className:"card-header d-flex align-items-center"},n.createElement(i.A,{width:"2rem",height:"2rem",username:e.user.username}),n.createElement("small",{className:"ms-2"},e.user.username),n.createElement("small",{className:"ms-auto"},new Date(e.date_created).toISOString().substring(0,10))),n.createElement("div",{className:"card-body announcement-card-body"},n.createElement("h5",null,e.title),n.createElement("span",null,e.text)),n.createElement("div",{className:"card-footer"},n.createElement("small",null,"Comments: ",e.amount_comments)))))),n.createElement("div",{className:"card-footer"},v&&n.createElement("nav",{id:"pagination-view "},n.createElement("ul",{className:"pagination justify-content-center"},n.createElement("li",{id:"previous-page",className:`${x}`},n.createElement("a",{id:"previous-page-link",href:"announcements?page="+(parseInt(k)-1),className:"page-link"},"Previous")),C.map((e=>parseInt(k)!==e?n.createElement("li",{id:`page-${e}`,key:`page-${e}`,className:"page-item"},n.createElement("a",{id:`page-link-${e}`,href:`announcements?page=${e}`,className:"page-link"},e)):n.createElement("li",{id:`page-${e}`,key:`page-${e}`,className:"page-item disabled"},n.createElement("a",{id:`page-link-${e}`,href:`announcements?page=${e}`,className:"page-link"},e)))),n.createElement("li",{id:"next-page",className:`${S}`},n.createElement("a",{id:"next-page-link",href:`announcements?page=${parseInt(k)+1}`,className:"page-link"},"Next"))))),n.createElement("div",{className:"custom-modal hidden",id:"announcement-create-modal",style:{width:"50%"},onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",{className:"m-0"},"Create announcement")),n.createElement("div",{className:"custom-modal-body"},n.createElement("hr",{className:"m-1"}),n.createElement("div",{className:"d-flex align-items-center"},!p&&n.createElement(i.A,{width:"3rem",height:"3rem",username:g.username}),!p&&n.createElement("strong",null,g.username)),n.createElement("textarea",{id:"announcement-title",className:"input-field mt-2 textarea-expand w-100",rows:1,placeholder:"Title...","data-category":"input-field",onChange:e=>{(0,m.QL)(e.target)},onInput:e=>{L(e.target.value)}}),n.createElement("textarea",{id:"break-line-text",className:"input-field mt-2 textarea-expand w-100",rows:1,placeholder:"Text...","data-category":"input-field",onChange:e=>{(0,m.QL)(e.target)},onInput:e=>{_(e.target.value)}})),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{id:"submit-data",className:"btn btn-primary me-auto rounded-15",onClick:async function(){if(f(),N("Loading.."),!g.is_admin)return void h("There was an error submiting the announcement");const e=await(0,c.wS)(T,P);if(e.error)h("There was an error submiting the announcement");else{if(400!==e.status)return 200===e.status?(E("Announcement posted"),N(!1),M(),void(0,m.tI)()):void h("There was a server error while submiting the announcement");h("Be sure the title has less than 128 characters and the text 2048 characters")}}},"Post announcement"))))}}}]);