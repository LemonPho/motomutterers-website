"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[99],{99:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h});var n=a(540),r=a(926),s=a(398),l=a(946),o=a(447);function i(){const[e,t]=(0,n.useState)(!1),[a,i]=(0,n.useState)(),[c,m]=(0,n.useState)(null),{user:d,contextLoading:u,modalErrorMessage:p,setModalErrorMessage:g,setSuccessMessage:h,retrieveUserData:E,resetApplicationMessages:f}=(0,l.Xn)();return(0,n.useEffect)((()=>{if(!e)return void i(void 0);const t=new FileReader;t.onload=()=>{const a=new Image;a.onload=()=>{const t=document.createElement("canvas"),n=t.getContext("2d");let r,s,l,o;a.width>a.height?(r=a.height,s=a.height,l=(a.width-a.height)/2,o=0):(r=a.width,s=a.width,o=(a.height-a.width)/2,l=0),t.width=r,t.height=s,n.drawImage(a,l,o,r,s,0,0,r,s);const c=t.toDataURL(e.type);i(c)},a.src=t.result},t.readAsDataURL(e)}),[e]),u?null:n.createElement("div",null,n.createElement("div",{className:"p-3 d-flex justify-content-center"},n.createElement("div",null,n.createElement("div",null,n.createElement("strong",{style:{fontSize:"20px"}},"Profile photo")),n.createElement("div",null,n.createElement(o.A,{width:"7rem",height:"7rem",username:d.username}))),n.createElement("button",{id:"profile-picture-button",className:"btn btn-outline-secondary rounded-15 align-self-center ms-auto",onClick:e=>{f(),(0,r.YK)("profile-picture-modal",e)}},"Change"),n.createElement("div",{className:"custom-modal hidden",id:"profile-picture-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header"},n.createElement("h5",null,"Change profile picture"),n.createElement("button",{type:"button",className:"btn btn-link link-no-decorations ms-auto",id:"close-modal"},n.createElement("span",{onClick:e=>{f(),(0,r.tI)(),i(void 0)},id:"close-modal","aria-hidden":"true"},"×"))),n.createElement("div",{className:"custom-modal-body"},n.createElement("div",{style:{position:"relative"}},p&&n.createElement("div",{className:"alert alert-danger"},n.createElement("small",null,p)),c&&n.createElement("div",{className:"alert alert-secondary"},"Loading..."),n.createElement("div",{className:"d-flex justify-content-center"},n.createElement("div",{style:{position:"relative"}},n.createElement("label",null,!1===e&&n.createElement(o.A,{width:"14rem",height:"14rem",username:d.username}),e&&n.createElement("img",{className:"rounded-circle",id:"edit-profile-photo",style:{width:"14rem",height:"14rem"},src:a}),n.createElement("input",{type:"file",accept:"image/*",onChange:function(e){e.target.files&&0!==e.target.files.length?t(e.target.files[0]):t(!1)}}),n.createElement("div",{className:"d-flex justify-content-center align-content-center"},n.createElement("div",{className:"edit-image-overlay rounded-circle",style:{backgroundColor:"rgba(0, 0, 0, 0.8)"}},n.createElement("div",{className:"w-100 h-100 d-flex justify-content-center align-items-center"},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",style:{width:"10rem",height:"10rem"},width:"16",height:"16",fill:"white",className:"bi bi-images",viewBox:"0 0 16 16"},n.createElement("path",{d:"M4.502 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"}),n.createElement("path",{d:"M14.002 13a2 2 0 0 1-2 2h-10a2 2 0 0 1-2-2V5A2 2 0 0 1 2 3a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v8a2 2 0 0 1-1.998 2zM14 2H4a1 1 0 0 0-1 1h9.002a2 2 0 0 1 2 2v7A1 1 0 0 0 15 11V3a1 1 0 0 0-1-1zM2.002 4a1 1 0 0 0-1 1v8l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71a.5.5 0 0 1 .577-.094l1.777 1.947V5a1 1 0 0 0-1-1h-10z"})))))))))),n.createElement("div",{className:"custom-modal-footer justify-content-center"},n.createElement("button",{id:"submit-data",className:"btn btn-primary",onClick:e=>{e.stopPropagation(),f(),async function(){m(!0);const e=(0,r.Xz)(a,"new-profile-picture"),n=e.type.match(/\/([a-zA-Z]+)/)[1],l=new FormData;l.append("profile_picture",e);const o=await(0,s.sZ)(l,n);o.error?(g("There was an error while submiting the new profile picture"),console.log(o.error),m(!1)):400===o.status?(g("File format or another factor is invalid for a picture, be sure to use any common picture extensions"),m(!1)):200===o.status?(h("Profile picture changed"),(0,r.tI)(),m(!1),E(),t(!1)):(g("There was an error when submiting the new profile picutre"),m(!1))}()}},"Save changes")))))}function c(){const{user:e,contextLoading:t,setErrorMessage:a,setLoadingMessage:o,setSuccessMessage:i,resetApplicationMessages:c,retrieveUserData:m}=(0,l.Xn)(),[d,u]=(0,n.useState)(""),[p,g]=(0,n.useState)("");async function h(){o("Loading...");const e=document.getElementById("username-input").value,t=document.getElementById("password-username-input").value,n=await(0,s.Lv)(t,e);if(n.error)return a("There was an error while submiting the new username"),void o(!1);if(400===n.status){let e=n.newUsernameValid?"":"Username is not valid, make sure to only use numbers and letters\n";return e+=n.newUsernameUnique?"":"Username is already in use\n",e+=n.userCanChangeUsername?"":"You must wait 30 days in between switching usernames\n",e+=n.currentPasswordCorrect?"":"Password is incorrect\n",o(!1),void a(e)}if(200===n.status)return i("The new username has been saved"),o(!1),(0,r.tI)(),void m();a("There has been an error while submiting the new username"),o(!1)}return t?null:n.createElement("div",null,n.createElement("div",{className:"p-3 d-flex justify-content-center"},n.createElement("div",null,n.createElement("strong",{style:{fontSize:"20px"}},"Username"),n.createElement("div",null,e.username)),n.createElement("button",{id:"username-button",className:"btn btn-outline-secondary rounded-15 align-self-center ms-auto",onClick:e=>{u(""),g(""),(0,r.YK)("username-modal",e)}},"Change"),n.createElement("div",{className:"custom-modal hidden",id:"username-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header"},n.createElement("h5",null,"Change username"),n.createElement("button",{type:"button",className:"btn btn-link link-no-decorations ms-auto",id:"close-modal",onClick:e=>{(0,r.tI)(),c()}},n.createElement("span",{id:"close-modal","aria-hidden":"true"},"×"))),n.createElement("div",{className:"custom-modal-body"},n.createElement("input",{"data-category":"input-field",type:"password",placeholder:"Current password",className:"form-control",id:"password-username-input",onChange:e=>{g(e.target.value)},onKeyUp:e=>(0,r.ac)(e,h)}),n.createElement("input",{"data-category":"input-field",type:"text",placeholder:"New username",className:"form-control mt-2",id:"username-input",onChange:e=>{u(e.target.value)},onKeyUp:e=>(0,r.ac)(e,h)})),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{id:"submit-data",className:"btn btn-primary mr-auto",onClick:e=>{e.stopPropagation(),c(),h()}},"Save changes")))))}function m(){const[e,t]=(0,n.useState)(""),[a,o]=(0,n.useState)(""),{user:i,contextLoading:c,setErrorMessage:m,setSuccessMessage:d,retrieveUserData:u,resetApplicationMessages:p}=(0,l.Xn)();async function g(){p(),setLoadingMessage("Loading...");const t=await(0,s.Xc)(a,e);if(t.error)return void m("There was an error while submiting the new email");if(u(),200===t.status)return d("Email changed, check your inbox for the verification link"),void(0,r.tI)();let n=t.newEmailUnique?"":"Email is not unique\n";n+=t.newEmailValid?"":"Email is not valid\n",n+=t.currentPasswordCorrect?"":"Password is not correct\n",m(n)}return c?null:n.createElement("div",null,n.createElement("div",{className:"p-3 d-flex justify-content-center"},n.createElement("div",null,n.createElement("strong",{style:{fontSize:"20px"}},"Email"),n.createElement("div",null,i.email)),n.createElement("button",{id:"email-button",className:"btn btn-outline-secondary rounded-15 align-self-center ms-auto",onClick:e=>{(0,r.YK)("email-modal",e),t(""),o("")}},"Change"),n.createElement("div",{className:"custom-modal hidden",id:"email-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header"},n.createElement("h5",null,"Change email"),n.createElement("button",{type:"button",className:"btn btn-link link-no-decorations ms-auto",id:"close-modal",onClick:()=>{(0,r.tI)()}},n.createElement("span",{"aria-hidden":"true"},"×"))),n.createElement("div",{className:"custom-modal-body"},n.createElement("input",{type:"password","data-category":"input-field",placeholder:"Current password",className:"form-control",id:"password-email-input",onChange:e=>{o(e.target.value)},onKeyUp:e=>(0,r.ac)(e,g)}),n.createElement("input",{type:"text","data-category":"input-field",placeholder:"New email",className:"form-control mt-2",id:"email-input",onChange:e=>{t(e.target.value)},onKeyUp:e=>(0,r.ac)(e,g)})),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{id:"submit-data",className:"btn btn-primary mr-auto",onClick:e=>{e.stopPropagation(),g()}},"Save changes")))))}var d=a(974);function u(){const{setLogout:e,contextLoading:t,setErrorMessage:a,setSuccessMessage:o,resetApplicationMessages:i}=(0,l.Xn)(),[c,m]=(0,n.useState)(""),[u,p]=(0,n.useState)("");async function g(){const t=await(0,d.gf)();let n;if(t.error)return a("There was an error while submiting the new password"),void console.log(error);n=t.token;const l=await(0,s.sD)(n,u,c);if(l.error)a("There was an error submiting the new password");else{if(400===l.status){let e=l.newPasswordValid?"":"The password must be at least 8 characters and not easy to guess\n";return e+=l.currentPasswordCorrect?"":"The current password is not correct\n",void a(e)}if(200===l.status)return o("The new password has been saved, log into your account again"),(0,r.tI)(),void e();a("There was an error submiting the new password")}}return t?null:n.createElement("div",null,n.createElement("div",{className:"p-3 d-flex justify-content-center"},n.createElement("div",null,n.createElement("strong",{style:{fontSize:"20px"}},"Password"),n.createElement("div",null,"••••••••••")),n.createElement("button",{id:"password-button",className:"btn btn-outline-secondary rounded-15 align-self-center ms-auto",onClick:e=>{i(),m(""),p(""),(0,r.YK)("password-modal",e)}},"Change"),n.createElement("div",{className:"custom-modal hidden",id:"password-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header"},n.createElement("h5",null,"Change password"),n.createElement("button",{type:"button",className:"ms-auto btn btn-link link-no-decorations",id:"close-modal",onClick:()=>{(0,r.tI)(),i()}},n.createElement("span",{"aria-hidden":"true"},"×"))),n.createElement("div",{className:"custom-modal-body"},n.createElement("input",{"data-category":"input-field",type:"password",placeholder:"Current password",className:"form-control",id:"old-password-input",onChange:e=>{p(e.target.value)},onKeyUp:e=>(0,r.ac)(e,g)}),n.createElement("input",{"data-category":"input-field",type:"password",placeholder:"New password",className:"form-control mt-2",id:"new-password-input",onChange:e=>{m(e.target.value)},onKeyUp:e=>(0,r.ac)(e,g)})),n.createElement("div",{className:"custom-modal-footer"},n.createElement("button",{id:"submit-data",className:"btn btn-primary mr-auto",onClick:e=>{e.stopPropagation(),i(),g()}},"Save changes")))))}var p=a(767);function g(){const{user:e,setErrorMessage:t,setSuccessMessage:a,retrieveUserData:o,contextLoading:i}=(0,l.Xn)(),[c,m]=(0,n.useState)(""),d=(0,p.Zp)();return i?null:n.createElement("div",null,n.createElement("div",{className:"p-3 d-flex align-items-center"},n.createElement("strong",{style:{fontSize:"20px"}},"Delete Account"),n.createElement("button",{className:"ms-auto btn btn-outline-danger rounded-15",onClick:t=>{(0,r.YK)("delete-account-modal",t,e.is_logged_in),m("")}},"Delete Account")),n.createElement("div",{className:"custom-modal hidden",id:"delete-account-modal",onClick:e=>{e.stopPropagation()}},n.createElement("div",{className:"custom-modal-header justify-content-center"},n.createElement("h5",null,"Delete Account")),n.createElement("div",{className:"custom-modal-body"},n.createElement("input",{type:"text",className:"input-field w-100",placeholder:"Write your username here","data-category":"input-field",onChange:e=>{m(e.target.value)}})),n.createElement("div",{className:"custom-modal-footer justify-content-center",style:{flexDirection:"column"}},n.createElement("button",{className:"btn btn-danger w-100 rounded-15",onClick:async function(){if(c!=e.username)return void t("Username inputted isn't correct");const n=await(0,s.Dl)();404!=n.status?200!=n.status||n.error?t("There was an error deleting your account"):(a("Account deleted"),o(),(0,r.tI)(),d("/")):t("Account not found")}},"Delete Account"),n.createElement("button",{className:"btn btn-light mt-2 rounded-15",onClick:r.tI},"Cancel"))))}function h(){const{user:e,userLoading:t,setErrorMessage:a}=(0,l.Xn)();return t?null:t||e.is_logged_in?n.createElement("div",null,n.createElement("div",{className:"card rounded-15 element-background-color element-border-color"},n.createElement(i,null),n.createElement("hr",null),n.createElement(c,null),n.createElement("hr",null),n.createElement(m,null),n.createElement("hr",null),n.createElement(u,null),n.createElement("hr",null),n.createElement(g,null),n.createElement("hr",null))):(a("You must be logged in to use this page"),null)}}}]);