"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[637,807,947],{807:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var n=a(540);class s extends n.Component{constructor(e){super(e)}render(){return n.createElement("p",null,"Error page not found")}}const l=s},637:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o,useRaceResultsContext:()=>m});var n=a(540),s=a(976),l=a(767),r=a(974),c=a(946);const i=(0,n.createContext)();function o(){const{setErrorMessage:e,setSuccessMessage:t}=(0,c.Xn)(),[a,o]=(0,n.useState)(),[m,d]=(0,n.useState)(),[u,p]=(0,n.useState)(!1),[E,g]=(0,n.useState)(),[N,b]=(0,n.useState)(),[v,h]=(0,n.useState)(),[w,f]=(0,n.useState)(),[y,x]=(0,n.useState)(),[k,R]=(0,n.useState)(!1),[C,S]=(0,n.useState)(1),[L]=(0,s.ok)();return n.createElement(i.Provider,{value:{raceResults:a,raceResultsLoading:m,raceResultDetails:u,raceResultDetailsLoading:E,seasonList:w,seasonListLoading:y,selectedSeason:k,setSelectedSeason:R,raceResultComments:N,raceResultCommentsLoading:v,retrieveRaceResults:async function(){d(!0);const t=L.get("season");if(null==t)return;const a=await(0,r.aG)(t);a.error?e("There was an error loading the race results"):404!==a.status?200==a.status?(o(a.raceResults),d(!1)):e("Be sure your request is valid"):e("Be sure to select a valid season")},retrieveRaceResultDetails:async function(t){g(!0);const a=await(0,r.YY)(t);a.error?e("There was an error loading the race result"):404!==a.status?200==a.status?(p(a.race),g(!1)):e("There was an error loading the race result"):e("Race result was not found")},retrieveSeasonList:async function(){x(!0);const t=await(0,r.zV)();t.error||200!=t.status?e("There was an error loading the season list"):(f(t.seasons),x(!1))},retrieveRaceResultComments:async function(t){h(!0);const a=await(0,r.oH)(t);a.error?e("There was an error loading the race result"):404!==a.status?200==a.status?(b(a.comments),h(!1)):e("There was an error loading the race comments"):e("Race result was not found")}}},n.createElement(l.sv,null))}function m(){return(0,n.useContext)(i)}},947:(e,t,a)=>{a.r(t),a.d(t,{default:()=>E});var n=a(540),s=a(767),l=a(976),r=a(637),c=a(946),i=a(447),o=a(926);function m({raceId:e}){const{user:t,userLoading:a}=(0,c.Xn)(),{raceResultComments:s,raceResultCommentsLoading:l,raceResultDetailsLoading:o,retrieveRaceResultComments:m}=(0,r.useRaceResultsContext)();return(0,n.useEffect)((()=>{!async function(){await m(e)}()}),[e]),o?null:n.createElement("div",{className:"card rounded-15 element-background-color element-border-color",id:"race-comments-card"},n.createElement("div",{className:"card-header rounded-15-top"},n.createElement("div",{className:"p-1"},n.createElement("h5",{style:{margin:"0px"}},"Comments"))),n.createElement("div",{className:"card-body"},n.createElement("div",{id:"comment-create"},!a&&!t.is_logged_in&&n.createElement("div",{className:"d-flex justify-content-center w-100"},n.createElement("span",null,"You must log in to create a comment")),!a&&t.is_logged_in&&n.createElement("div",{className:"flex-box align-items-center"},n.createElement(i.A,{width:"3.5rem",height:"3.5rem",username:t.username}),n.createElement("textarea",{className:"input-field ms-2 w-100 textarea-expand",rows:1,name:"create-comment-text",id:"create-comment-text",placeholder:"Write a comment...",onChange:e=>{autoResizeTextarea(e.target)}}),n.createElement("button",{className:"btn btn-outline-secondary ms-2",onClick:console.log("clicked")},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-send",viewBox:"0 0 16 16"},n.createElement("path",{d:"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576 6.636 10.07Zm6.787-8.201L1.591 6.602l4.339 2.76 7.494-7.493Z"}))))),n.createElement("hr",null),console.log(s),!l&&!s&&n.createElement("span",null,"No comments have been posted"),!l&&s&&s.map((e=>null===e.parent_comment&&n.createElement("div",{id:`comment-${e.id}`,key:`comment-${e.id}`},n.createElement("div",{className:"d-flex align-items-start"},n.createElement(i.A,{width:"2.5rem",height:"2.5rem",username:e.user.username}),n.createElement("div",{className:"dynamic-container ms-2",style:{maxWidth:"calc(100% - 48px)"}},n.createElement("div",{className:"d-flex align-items-center"},n.createElement("a",{className:"link-no-decorations",href:`/users/${e.user.username}?page=1`},n.createElement("strong",null,e.user.username)),n.createElement("span",{className:"flex-item ms-2",style:{fontSize:"0.75rem"}},new Date(e.date_created).toISOString().substring(0,10)," ",new Date(e.date_created).toLocaleTimeString().substring(0,5)),e.edited&&n.createElement("small",{className:"ms-1"},"(edited)"),(t.id===e.user.id||1==t.is_admin)&&n.createElement("div",{className:"ms-auto dropdown-div d-flex align-items-start"},n.createElement("button",{id:"announcement-dropdown-button",className:"btn btn-link link-no-decorations ms-auto",style:{padding:"0"},onClick:t=>toggleDropdown(`comment-${e.id}-dropdown`,t)},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-three-dots-vertical",viewBox:"0 0 16 16"},n.createElement("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"}))),n.createElement("div",{id:`comment-${e.id}-dropdown`,className:"dropdown-menu"},n.createElement("li",null,n.createElement("button",{className:"dropdown-item",onClick:()=>toggleEditComment(e.id)},"Edit")),n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:()=>deleteComment(e.id)},"Delete"))))),n.createElement("div",{className:"break-line-text"},n.createElement("span",{id:`comment-${e.id}-text`,style:{overflow:"visible"},className:"",contentEditable:!1},e.text)),t.id===e.user.id&&n.createElement("div",{className:"d-flex"},n.createElement("button",{id:`comment-${e.id}-save-button`,className:"btn btn-primary ms-auto me-2 mt-2 hidden",onClick:()=>saveEditComment(e.id)},"Save"),n.createElement("button",{id:`comment-${e.id}-cancel-button`,className:"btn btn-outline-secondary mt-2 hidden",onClick:()=>cancelEditComment(e.id)},"Cancel")),n.createElement("div",{className:"d-flex mb-3"},parseInt(e.amount_replies)>0&&n.createElement("button",{className:"btn btn-link link-no-decorations p-0 pe-1",style:{color:"blue"},onClick:()=>toggleReplies(e.id)},n.createElement("small",null,"Show ",e.amount_replies," replies")),!0===t.is_logged_in?n.createElement("button",{className:"btn btn-link link-no-decorations p-0",onClick:()=>toggleReplyBox(e.id)},n.createElement("small",null,"Reply")):n.createElement("div",{className:"my-2"})))),n.createElement("div",{id:`comment-reply-div-${e.id}`,className:"hidden",style:{marginBottom:"0.5rem",marginLeft:"3.4rem"}},n.createElement("div",{className:"d-flex justify-content-center"},n.createElement("div",{id:`comment-reply-text-${e.id}`,role:"textbox",contentEditable:!0,className:"input-field w-100","data-placeholder":"Add a reply...",onClick:()=>focusDiv(`comment-reply-text-${e.id}`)}),n.createElement("button",{id:`comment-reply-button-${e.id}`,className:"btn btn-outline-secondary p-1 ms-2",onClick:()=>{postCommentReply(e.id)}},n.createElement("small",null,"Reply")))),n.createElement("div",{id:`comment-replies-${e.id}`,className:"dynamic-container hidden mb-3",style:{marginLeft:"2.7rem"}},e.replies.length>0&&e.replies.map((e=>n.createElement("div",{id:`reply-${e.id}`,key:`reply-${e.id}`,className:"dynamic-container mb-2",style:{marginLeft:"0px",maxWidth:"calc(100% - 2.7rem)"}},n.createElement("div",{className:"d-flex align-items-start"},n.createElement(i.A,{width:"1.5rem",height:"1.5rem",username:e.user.username}),n.createElement("div",{className:"dynamic-container"},n.createElement("div",{className:"d-flex align-items-center"},n.createElement("a",{className:"link-no-decorations ms-2",href:`/users/${e.user.username}?page=1`},n.createElement("small",null,n.createElement("strong",null,e.user.username))),n.createElement("span",{className:"ms-2",style:{fontSize:"0.75rem"}},new Date(e.date_created).toISOString().substring(0,10)," ",new Date(e.date_created).toLocaleTimeString().substring(0,5)),e.edited&&n.createElement("small",{className:"ms-1"},"(edited)"),t.id===e.user.id&&n.createElement("div",{className:"ms-auto dropdown-div d-flex align-items-start"},n.createElement("button",{id:"reply-dropdown-button",className:"btn btn-link link-no-decorations ms-auto",style:{padding:"0"},onClick:t=>toggleDropdown(`reply-${e.id}-dropdown`,t)},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-three-dots-vertical",viewBox:"0 0 16 16"},n.createElement("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"}))),n.createElement("div",{id:`reply-${e.id}-dropdown`,className:"dropdown-menu"},n.createElement("li",null,n.createElement("button",{className:"dropdown-item",onClick:()=>toggleEditReply(e.id)},"Edit")),n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:()=>deleteComment(e.id)},"Delete"))))),n.createElement("div",{className:"break-line-text my-1"},n.createElement("span",{id:`reply-${e.id}-text`,className:"",contentEditable:!1},e.text)))),t.id===e.user.id&&n.createElement("div",{className:"d-flex mt-2"},n.createElement("button",{id:`reply-${e.id}-save-button`,className:"btn btn-primary ms-auto me-2 hidden",onClick:()=>saveEditReply(e.id)},"Save"),n.createElement("button",{id:`reply-${e.id}-cancel-button`,className:"btn btn-outline-secondary hidden",onClick:()=>cancelEditReply(e.id)},"Cancel")))))))))))}function d({raceId:e}){const{user:t,userLoading:a}=(0,c.Xn)(),{raceResultDetails:s,raceResultDetailsLoading:l,retrieveRaceResultDetails:i}=(0,r.useRaceResultsContext)();return(0,n.useEffect)((()=>{!async function(){await i(e)}()}),[e]),l||!s?n.createElement("div",null,n.createElement("div",{className:"card element-background-color element-border-color mb-2 rounded-15",id:"race-result-card"},n.createElement("div",{className:"card-header loading-placeholder"},n.createElement("h5",{className:"fade-in-out"}))),n.createElement("div",{className:"card element-background-color element-border-color mb-2 rounded-15",id:"standings-card"},n.createElement("div",{className:"card-header loading-placeholder"},n.createElement("h5",{className:"fade-in-out"})))):n.createElement("div",null,n.createElement("div",{className:"card rounded-15 element-background-color element-border-color mb-2",id:"race-result-card"},n.createElement("div",{className:"card-header rounded-15 clickable",onClick:e=>{(0,o.pX)("race-positions-card-body")}},n.createElement("div",{className:"d-flex align-items-center p-1"},n.createElement("h5",{style:{margin:"0px"}},s.title,s.is_sprint&&" (Sprint)"),n.createElement("div",{className:"ms-auto"},n.createElement("div",{className:"container"},s.finalized&&n.createElement("span",{className:"badge rounded-pill text-bg-success"},"Final"),!s.finalized&&n.createElement("span",{className:"badge rounded-pill text-bg-secondary"},"Upcoming"))))),n.createElement("div",{className:"card-body custom-card-body",id:"race-positions-card-body"},n.createElement("div",{className:"row g-0 p-1",style:{marginRight:"0"}},n.createElement("strong",{className:"col-2"},"Pos"),n.createElement("strong",{className:"col-2"},"#"),n.createElement("strong",{className:"col-6"},"Name"),n.createElement("strong",{className:"col-2"},"Points")),s.finalized&&s.competitors_positions.map((e=>n.createElement("div",{className:"row g-0 p-1",key:`competitor-${e.competitor_id}`,style:{marginRight:"0px"}},0==e.position&&n.createElement("span",{className:"col-2"},"-"),0!=e.position&&n.createElement("span",{className:"col-2"},e.position),n.createElement("span",{className:"col-2"},"#",e.number),n.createElement("span",{className:"col-6"},e.first," ",e.last),n.createElement("span",{className:"col-2"},e.points)))),!s.finalized&&s.qualifying_positions.map((e=>n.createElement("div",{className:"row g-0 p-1",key:`competitor-${e.competitor_id}`,style:{marginRight:"0px"}},0==e.position&&n.createElement("span",{className:"col-2"},"-"),0!=e.position&&n.createElement("span",{className:"col-2"},e.position),n.createElement("span",{className:"col-2"},"#",e.number),n.createElement("span",{className:"col-6"},e.first," ",e.last),n.createElement("span",{className:"col-2"},"-")))))),s.finalized&&n.createElement("div",{className:"card rounded-15 element-background-color element-border-color mb-2",id:"race-standings-card"},n.createElement("div",{className:"card-header rounded-15 clickable",onClick:e=>{(0,o.pX)("race-standings-card-body")}},n.createElement("div",{className:"p-1"},n.createElement("h5",{style:{margin:"0px"}},"Standings"))),n.createElement("div",{className:"card-body custom-card-body",id:"race-standings-card-body"},s.standings.users_picks.map((e=>n.createElement("a",{className:"race-standings-row p-1 link-no-decorations rounded-15 clickable",href:`/users/${e.user.username}?page=1`,key:`user-picks-${e.user.id}`,style:{marginRight:"0px"}},e.position_change>0&&n.createElement("span",{className:"race-standings-position-change"},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"green",className:"bi bi-caret-up-fill",viewBox:"0 0 16 16"},n.createElement("path",{d:"m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"}))),0==e.position_change&&n.createElement("span",{className:"race-standings-position-change",style:{color:"grey"}}," -"),e.position_change<0&&n.createElement("span",{className:"race-standings-position-change"},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"red",class:"bi bi-caret-down-fill",viewBox:"0 0 16 16"},n.createElement("path",{d:"M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"}))),n.createElement("span",{className:"race-standings-position"},e.position),n.createElement("span",{className:"race-standings-username"},e.user.username),n.createElement("span",{className:"race-standings-points"},e.points)))))),n.createElement(m,{raceId:e}))}function u({seasonYear:e}){const{retrieveRaceResults:t,retrieveRaceResultsDetails:a,retrieveSeasonList:s,raceResults:l,raceResultsLoading:c,selectedSeason:i,seasonList:m,seasonListLoading:d}=(0,r.useRaceResultsContext)();return(0,n.useEffect)((()=>{!async function(){await t(),await s()}()}),[]),n.createElement("div",null,n.createElement("div",{className:"card rounded-15 element-background-color element-border-color"},n.createElement("div",{className:"card-header d-flex align-items-center"},n.createElement("h5",null,"Race results"),n.createElement("div",{className:"dropdown ms-auto"},n.createElement("button",{className:"btn btn-outline-secondary dropdown-toggle rounded-15",type:"button",onClick:e=>(0,o.gR)("season-selector-dropdown",e,void 0)},e),n.createElement("ul",{className:"dropdown-menu dropdown-menu-end",id:"season-selector-dropdown"},!d&&m.map((t=>n.createElement("li",{className:"ms-2",key:`${t.year}`},n.createElement("a",{className:"d-flex align-items-center",href:`/raceresults?season=${t.year}`,id:`${t.year}`},t.year,t.year==e&&n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"ms-auto me-1 bi bi-check",viewBox:"0 0 16 16"},n.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"}))))))))),n.createElement("div",{className:"card-body"},!c&&null!=l&&0==l.length&&n.createElement("h5",null,"No race results have been added for this season."),!c&&null!=l&&l.map((e=>n.createElement("div",{key:`race-result-${e.id}`},n.createElement("div",{className:"p-2 clickable rounded-15"},n.createElement("a",{className:"link-no-decorations",href:`/raceresults/${e.id}`},n.createElement("div",null,n.createElement("div",{className:"d-flex align-items-center"},n.createElement("h3",{className:"p-2"},e.title,e.is_sprint&&" (Sprint)"),n.createElement("div",{className:"ms-auto"},n.createElement("div",{className:"container"},e.finalized&&n.createElement("span",{className:"badge rounded-pill text-bg-success"},"Final"),!e.finalized&&n.createElement("span",{className:"badge rounded-pill text-bg-secondary"},"Upcoming"))))))),n.createElement("hr",null)))))))}var p=a(807);function E(){const{raceId:e}=(0,s.g)(),[t]=(0,l.ok)(),{retrieveSeasonList:a,seasonList:c,seasonListLoading:i,setSelectedSeason:o,selectedSeason:m}=(0,r.useRaceResultsContext)(),E=t.get("season");return e?n.createElement(d,{raceId:e}):E?((0,n.useEffect)((()=>{!async function(){await a()}()}),[]),(0,n.useEffect)((()=>{if(!i&&null!=c)for(let e=0;e<c.length;e++)c[e].year==E&&o(c[e])}),[c]),m?n.createElement(u,{seasonYear:E}):n.createElement(p.default,null)):n.createElement(p.default,null)}}}]);